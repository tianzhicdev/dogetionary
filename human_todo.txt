in the onboarding journey, if user is studying english, we add one more question
"are you studying for " menu with TOEFL/IELTS/NONE

we recommend the user to register but users can skip
if user select an active test, we should generate a schedule and display progress
"prepare for my test" on landing -> "practice"
display definition for new word in practice; perhaps with some special effects
"review" -> "practice"



let's design a teacher's portal
1. students can add an id in settings to join a group
2. teachers can access a web app /teacher-admin to view students stats
in /teacher-admin
we should all the groups
when click into a group, we show all the students and their stats
such as total saved words, total review count, 
when click into a student, we can see more details such as 
1. number of words saved in the last 7 days (show count for each day)
2. number of words reviewed in the last 7 days (show count for each day)
3. most recent saved 10 words 
4. more recent reviedwed 10 words


we need to think about gamified app wholistically. 
target users: highly motivated individuals who want to take tests/ build vocabulary for work/ 
what is the best way to learn a language? 1. repetition and  2.use
strategically, we should make an app that focus on building vocabulary.
"<APP NAME>: vocabulary for ielts"

1. onboarding

optional: 
ask intention, nickname, age
registration

english level tests

essential:
ask days/commitment time;


2. Sections:

essential:

a. Progress & Lookup

c. Schedule

d. Settings

optional
e. leaderboard


tasks:

1. create landing page that shows progress and lookup option

2. generate schedule

assume X words need to be learned;
every day we add Y new words to be learned;

for each new word, we assume that they need to practiced at Z0, Z1, Z2... days;
get_schedule(past_schedule: [(datetime, true/false), (datetime, true/false)]): future_schedule [(datetime, true/false), (datetime, true/false)]
# this func should use existing get_next_review_date_new to calc 7 future review dates assuming that the user always get it right when reviewing the word in the future 

initiate_schedule(test_name, study_duration): {date: {new_words: [], practice: []}... date2:{} ... }
# here daily new words = (test total words)/study_duration
# we should exclude words that are not new from being added as new (exclude words from saved_words table)
# but the non-new words that are part of the test vocabulary should be added the schedule as practice words;

we need a database strucuture to store the schedule; 
we should be able to call initiate_schedule every day (or any time really) to refresh the schedule so we always take into account new events from the user, such as study_duration change, reviewed words that are supposed to be reviewed in the future (so the next review time should be delayed);
multi selections 

1. the LLM calls need to be faster

3. words search in saved words.
3.1 let's define the word progress bar number logic: if a word most recent reivew count >= 7 times with no error in the past 84 dqys, it is 7. >= 6 times in the past 41 days, return 6;  >= 5 times in the past 22 days, return 5;   >= 4 times in the past 12 days, return 4;   >= 3 times in the past 6 days, return 3;   >= 5 times in the past 41 days, return 6;   >= 2 times in the past 3 days, return 2;  >= 1 times, return 1
5. remove recogition in practice mode, if user select wrong, we should show what is correct. regardless if user select right or wrong, we should show a pop-up window with the showing the definition view of the word, with a "next" button at the buttom to practice the next word 
4.1 practice naming

2. when it is done, show badges for when 5, 10, 50, 100, 200.... ALL words learnt;
https://www.figma.com/design/NzE6vNDdbpeafseWzGR71c/Badges-and-Awards--Community-?node-id=0-1&p=f&t=Go42SXoQ8mz88bwB-0

we should add a AchievementView where we show some badges according to the number of saved words
10 words 
30 words 
50 words 
100 words 
150 words 
200 words 
250 words 
300 words 
350 words 
400 words 
450 words 
500 words -> award 
600 words
700 words
... 
1000 words -> big award 
1500 -> bigger award
2000 -> biggest award

we should use sf symbols to keep it simple
AchievementView should be displayed on the top of the dictionary tab
please design first

1.1 onboarding should show the schedule.
1. progress bar, when it opens, show show more meaningful stats. 
1. strike, badges

4. practice mode

1. badge system

let's change how the badge system work; we move from saved_words based to number of reviews based; do not change the icons and everything. make the number to get the badge to be 10x the current number; (because reviews are easier)
let's call it score (score = number of reviews where failed review = 1, success review = 2) 
it it should be displayed on the top of practice mode always, every time user completes a review, we should add to the score, making a little animition when the score changes;
the score does not have to sync back to the db, becuase it can always get calculated from reviews; we only need to sync from backend when user lands on a page where the score needs to be displayed;
let's design first, mention updates in backend/ui and db (if any);


2. practice mode interface 
in the practice tab; lets redefign the UI:
we allow users to refresh to get today's schedule:
it should know the number of new words, the number of due words; and number of words that have not been reivewed in the past 24 hours, and score;
perhaps we need a /v3/practice-status 

on the top we should show a status bar: we display only # new words, # of due words and score;
if  # new words, # of due words  are both 0; in the status bar we also display "Congrats! Today's learning practice is complete!" 

if # new words, # of due words # of words that have not been reivewed in the past 24 hours are all 0; 
we show "You've done so well, there is nothing to practice!"

if any of the above is not 0, we just call /v3/next-review-word-with-new-words which automatically prioritize new words > due words > other words that have not ben reviewed in the past 24H;

in other words, when user switch to practice tab, if there is something to practice, he see the question right away, not needing to click "start" button;
when there is not anything to practice, he sees "You've done so well, there is nothing to practice!"
let's design this first;


performance: 
it is quite slow for loading the next question; let's do the following
create endpint v3/next-review-word-with-new-words/<count>
when user first come to practice mode, we should load just 3 questions;
but on the backgroud we should make sure that we have at least 10 questions in a queue;
when a user answers one question, we should refill the queue in ios mem so that we always have 10 questions (or less if user do not have more than 10 to practice anyway);
the in mem queue should be unique and ordered 
we should show the queue in real time on the screen in debug mode;
let's discuss first: how do we ensure order and dedupe? (if we have 3 in the in mem queue and we ask backend for 10 more, likely the 3 in mem are returned too);

a. schedule should be made deterministically with deterministic order b.in practice mode, practicable words are basically words scheduled for today and words that are not due but not have been reviewed in the past 24h, we should call it "not-due-yet" words;
b. to keep the logic simple, v3/next-review-words-batch should be today's words from schedule + "not-due-yet" words;

2. animation for badge

in leaderboard mode, we should use score instead of practice count; let's create a new endpoint for this so older version of the app can still work;


2.1 in the saved words list view, we should 1. make the list more compact, we should try to fix the word itself and the review counts on the same row, only overflow to the second row if the word is too long;
2.the 7 blocks bar is kind ugly, can we user something better to indicate the progress?

7. reminder time set
we now always remind users at 11:59am;
we should let user choose in the setting -- display the timezone but do not let users change it; timezone should be from the system reading;

4. demo test
we want to use 20 words or so and call it demo test for testing purposesl it should be the same as toefl or ielts but just called demo with 20 words, some of the them overlap with toefl or ielts;


bugs:
1.lsit view I/T icon;

4. some questions pronunciations are erroneous, we need a reporting/fixing mechanism;
5. review word count should include new words.  

5. slider for days selection

2. force an upgrade;


1. debug mode
let's add a debug mode where uses can enable it; currently the debug mode is using '#if DEBUG' macro, we should change it to use this configurable value;
4. settings only show tests that are avaialble for the learning lang;
8. operation monitoring
2. errors must be logged in a separate file and easily; this log must be easily visible - design a way to read the logs easily with current setup using docker 
3. graph count and perf of every v3 call using promeseus; especially LLM calls -- how to setup promeseus and instrument the code easily?


10. tooltip for known words
dont practice this word in practice mode

3. toefl ielts words
we have 
resources/ielts-4323-annotated.csv
and 
resources/toefl-4889-annotated.csv

each word has a test and a level

now we have all tests to be toefl and ielts 
in the database we have is_toefl and is_ielts
we should change it to 
is_toefl_beginner
is_toefl_intermidiate
is_toefl (the same as is_toefl_advanced)
same goes to ielts

changes should be reflected in onboarding journey, scheduling and settings too;
let's investigate what changes need to be made, including ios/backend and db

scripts/import_test_vocabularies.py

bf: current question problem


toggle bug

when test prep settings change, lots of ui components should refresh according to the schedule; (could be race condition)



9. badge for finishing
we need a badge/award for when users finish their test -- when all the words from the test vocab are saved words; 
it should look and feel the same from the frontend perspective as other badges;
write some review data so i can just practice a few words to see the award being acheived;

1. we only display badges that are earned, we dont have to show greyed out badges
2. there should be no difference between award and badge;
3. there are 2 types of badges one that is based on score, one that is based on whether the user finishes a test prep;
4. get_test_vocabulary_awards should be kept simple that return 
{
"test_name":{

    saved_test_words: 20,
    totol_test_words:2000,
}
...
}  
for all the tests regardless if the user has any test enabled -- we should display his past badges too.
this should be sufficient for the UI to determine if the user earned test related badges.

we should always display the progress bar, if the user has no test prep enabled, we display the progress toward the next score based badge; 


6. changing schedule affect streak
when user change the number of days for a test to change to another test, we should remind the user that if he change the test, he loses streaks

8. tooltip

Building vocabulary the old way is wasteful—you forget, re-learn, forget again. Fledge fixes this. It tracks every word you study, calculates when you're about to forget, and prompts you at exactly the right moment. This is SuperMemo spaced repetition, and it can make your learning up to 20x more efficient. For every 1,000 words, that's 80+ hours of your life back.
Fledge manages your vocabulary building algorithmatically; fron your practice history, it calculates the best timing to reinforce your memory and prompts you to practice at the BEST timing to practice; this is the most effective method of building a vocabulary; using this method, you can achieve 20x of the efficiency;   

1. forced upgrade
1. LLM calls by type and duration
operationally:
2. user actions and action logs by user;

rolling log - searchable log

1. dumb down the words in the questions
2. more types of questions that help memorize the words

in the definition card, let's try to keep things more compact: 
1. move the picture to the upper right of the corner and make it smaller (it should still be clickable as it is now)
2. do not use collapseable components, just show the content;

in the search tab, when a definition is displayed, we should hide the search/words toggle and the progress bar, they took too much of the screen;
3. definitions need to help memorize too

show only one quote;
days configurable;

quote

-- done --


bug:
1. due soon should not be adding practice button or badge
2. practice should be test practice or other practice words

saved button

declaration;
branding, header size










producitonize:

branding

grafana -- finetune, perhaps expose to the internet


1. run the fixer
2. deploy with backward compatibility
3. test a few days

ads:

Harsh Words. Real results. Master TOEFL/IELTS vocabulary in 30 days.
这个App不会对你手软。托福/雅思词汇 30天搞定
不惯着你的背词App

sound?





--- future --- 

no word specific lang;
we should only support one type of learning lange and native language 

if user change learning lange, saved words and schedule should be cleared; 

perhaps not good for new words 

1. ask user to pronounce a sentence or phrase with that word in it (we already have the capability to generate sound and verify user pronunciation, we should reuse exiting components as much as possible)
2. spell the word with hints (fill some characters) apple -> a__le
3. describe a situation and ask users to pick an appropriate word -> multi choice 
"Your friend's cooking is terrible. Which word do you use?" (interesting / disgusting / unique)
"Which is MORE extreme?" (dislike / loathe)
Complete the Analogy -> multi choice -> multi choice "Happy : Ecstatic :: Sad : ____" (devastated / blue / meh)


not all questions can use below format, need to categorize words


3. which of the following word is a synonym -> multi choice
4. which of the following word is an antonym -> multi choice
5. describe a situation and ask users to pick an appropriate word -> multi choice 
"Your friend's cooking is terrible. Which word do you use?" (interesting / disgusting / unique)
"Which is MORE extreme?" (dislike / loathe)
Complete the Analogy -> multi choice -> multi choice "Happy : Ecstatic :: Sad : ____" (devastated / blue / meh)




